<div *ngIf="(userService.user$ | async) as user; else login">
  <p>
    Halo, {{ user.displayName }} (<a
      style="color: blue; cursor: pointer;"
      (click)="userService.logout()"
      >logout</a
    >)
  </p>

  <div *ngIf="(state$ | async) as state">
    <p>Petunjuk pengambilan Foto C1:</p>
    <ol>
      <li>
        Ambillah foto formulir final <b>SETELAH</b> ditanda-tangani semua saksi.
      </li>
      <li>
        Pastikan <b>SELURUH</b> kertas terlihat jelas (semua angka-angka maupun
        tulisan) seperti
        <a href="/assets/contoh.jpeg" target="_blank">contoh foto ini</a>.
      </li>
      <li>
        Pastikan foto tersebut sudah tersimpan di HP anda!<br />
        <b style="color:red">Catatan</b>: jika anda langsung memotret foto dari
        aplikasi ini, fotonya <b>TIDAK AKAN</b> tersimpan di HP anda!
      </li>
      <li>Jika sudah siap, klik tombol Upload dibawah:</li>
    </ol>

    <form [formGroup]="formGroup">
      <input
        #u
        type="file"
        (change)="upload(user.uid, state, $event)"
        accept=".png,.jpg"
        style="display: none"
      />
      <p *ngIf="!imgURL">
        <a mat-raised-button color="primary" (click)="u.click()">
          Upload Foto yang SUDAH tersimpan di HP anda
        </a>
      </p>
      <div *ngIf="imgURL">
        <img [src]="imgURL" height="300" (click)="u.click()" />
        <p>Pastikan lokasi TPS di foto sesuai dengan lokasi berikut:</p>

        <p>Terakhir, masukkan angka-angka yang tertera di foto tersebut:</p>

        <mat-form-field style="width: 225px">
          <input
            matInput
            placeholder="Jumlah Suara Paslon 1"
            formControlName="paslon1Ctrl"
            type="number"
            required
          />
        </mat-form-field>
        &nbsp;
        <span *ngIf="getError('paslon1Ctrl') as error" class="alert">
          {{ error }}
        </span>
        <br />

        <mat-form-field style="width: 225px">
          <input
            matInput
            placeholder="Jumlah Suara Paslon 2"
            formControlName="paslon2Ctrl"
            type="number"
            required
          />
        </mat-form-field>
        &nbsp;
        <span *ngIf="getError('paslon2Ctrl') as error" class="alert">
          {{ error }}
        </span>
        <br />

        <mat-form-field style="width: 225px">
          <input
            matInput
            placeholder="Jumlah Suara Sah"
            formControlName="sahCtrl"
            type="number"
            required
          />
        </mat-form-field>
        &nbsp;
        <span *ngIf="getError('sahCtrl') as error" class="alert">
          {{ error }}
        </span>
        <br />

        <mat-form-field style="width: 225px">
          <input
            matInput
            placeholder="Jumlah Suara Tidak Sah"
            formControlName="tidakSahCtrl"
            type="number"
            required
          />
        </mat-form-field>
        &nbsp;
        <span *ngIf="getError('tidakSahCtrl') as error" class="alert">
          {{ error }}
        </span>

        <p>
          <button
            type="submit"
            mat-raised-button
            color="primary"
            (click)="selesai(user, state.kelurahanId, state.tpsNo)"
            [disabled]="formGroup.invalid"
          >
            Selesai!
          </button>
        </p>
      </div>
    </form>

    <p>
      <a
        [routerLink]="['/t', state.kelurahanId]"
        mat-raised-button
        color="warn"
      >
        Batalkan Upload
      </a>
    </p>
  </div>
</div>

<ng-template #login>
  <div *ngIf="userService.isLoading"><mat-spinner></mat-spinner></div>
  <div *ngIf="!userService.isLoading">
    <p>
      Untuk mengupload foto, anda harus login terlebih dahulu<a
        (click)="userService.login('anon')"
        >:</a
      >
    </p>

    <p></p>
    <button
      style="width: 250px; text-align: left"
      mat-raised-button
      (click)="userService.login('google')"
    >
      <img
        style="padding:8px"
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAT5SURBVGhD7ZhtTFtVGMfvvYUW5jSabItb2CAZYcFNXqaObiAzM2MD5WXzlQlhmywQCBGGgwkkV0HoAAFBYLKCI+hiwAiF9lb2gbQlwAfd2NjcPs0vrjJfop80OKHP8Vx2igVP8ba93RrTf/L70j7Pef7PuefltoxffvnluRDPBMCpwFwo4gTI4W5DBvsnJLM2tI9B6DkGwX4G8GdzkM39AAXcKJQHHhdzSPqDE5QFqCGfm4QX2AX0LDbrAjhnHvK4KagKjCXD3T8Br4zAxq+Js0sz5xLiE8rlZqCSCSXDe1dQxjZDEgtUMx4ABxgblLIaUkZ+oS5mDZ6pm7TicoJrXMX7Q0nKyiPUyTyGN+CPtILeAIrZj0hpzwX9TDAcYX+mFfIK+ZyZlJZHi5uVVsgbyG7+FNtGLeQEfPYvoALuEpRyVVAfsBev5XXAMxvgHcXzqJR9d/G0EWMoufKbb1BthYP4MqIVWwGksAvwtqJLyubDMWvQW4reZY3IbV4UFHNfO5p0Br55rdjU4yRNsvC5vxWyuFnvmLcEbYYx1V1UpkAokW5cBE5wl9EAoyBpviNkUZ3BoEW6AhFKYv9t/t7McyTFd4QQw4FFaV1qQESvRCib+8e8uOYLmU0kxbcE5qDdy8zbMWP4e0sKihXdJNz3BGZlBbUBApwP/AmKGBUJ9z2BRTVIM24Hf99KQiVpY9k1JAfbKibg1UbtLTKsc4FZ9S3NuB38hJJJqCTRzLhLfPXIHBnWuXADv9GM24FxZQQJlSSaEXeJrBgHMqxz4Qbu0ozbgQnmYRIqSTQj7rKl/DIiwzrX/6EBn11C4kYmwzoXPmWu04zbwZs4hYRKEs2Iu8S/p5ewiS2qL2nG7eBbuo2EShLNiLukn+mzkmGda7WL7FfTI6hG2P1HU786mITLpvaBgrVRlSYbzbidolaNnoQ7F5iC1TTzM2MbUfZwMnpxKAO1GZ/6hITLppK22h6aaUc02pIjJNy5yMvcbbtxvKTQFxcjUfpQ+qJ5kazh5IWO0e2bSYrHajmbF7aj0rLq7G+vHF/gTby0f/PwSaQRzf9uXisumSXjjlQZEqwDyPPfAjz/ijJN8+kdmmlHTrS0TJCU/xZeRiG3xtb/lTuSRDVvp8awZ9qTJsQZzf6g8wbNsCNbTk8jTfdJ1/6CrDOor9JMr6Rcv3f2nPHJEJImWd2GyND89urvaIZX8lqD9gZJk66hr7aF4bVuo5leSZYu2dYh7OyRcjr1XYx6qEV4pusNnJMxeBi91NRBNW0nomIS+HMnXbo8l9QpxDSnUgw7Q9zcdXr1lXbjTr5feGJfvzF8/QVTxLrzQnR8hzG2utqw55LYrGNO6uAhdPQsjzaVz1AbKPywvpPYcU/1QpykpeQpb/YWorDT3ywz/3J9z01iw31NTYUEl+kT79CKys3RC8fQjirLovmk9wd+KWlqkufCNJlCH63UJ8zSispNZn8mymputfJ9pRtIeXmEmwiqEdTXXdkT7lArqK8YjeHe+82tHY1qyJR4OrlCpi7F9rExpp6U8a76hmPD6wxx04d1qVQzrnBoKA3VGtTTn+Njmwx//9Q7Gr2rUYgbP647ME8ztxo5wwfn64S4yc8M0TFkuAcn8XVCK0QfazY+ra/QJ3yfN7x/Lhuf9+ITytClodd1KSB+Vj6SaG0UdglaY0yOHO9RfvnlF8P8Da+9ZrALdO66AAAAAElFTkSuQmCC"
      />
      Login with Google
    </button>

    <p></p>
    <button
      style="width: 250px; text-align: left"
      mat-raised-button
      (click)="userService.login('facebook')"
    >
      <img
        style="padding:8px"
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHsSURBVGhD7ZjNLgNhGEZ7ZS1i5a/TEvdDLCywE0sXoTMSEZZW4t8FWEqIlg0Lo41nIprzxfv1pWMxJzm7d56e9GfTWkVFRcX/ptFMk3orPa63Oi+NVpqPw8Frfb7m3oIyRqORpOv0AmN2TTlxTCSdJoyVYr2ZzSvLzuAjpLFSTNIjZdkZ53feYE9ZdmCkVJVlh0bKVFl2aMTr1FKWb+xc5efXD3m395q/v+ffoGcKlWWHRjxOLmb5yem9Uhl6rlBZdmjE42b/nf8Jeq5QWXZoxOPFzYMyw9BzhcqyQyMeu89vyvxidessn17ex/thlWWHRjwO/2AHTLYzvCWVZYdGPBJ0F1JZdmjEI0F3IZVlh0ZijeGp+4obhcqyQyOxxnB5+4gbhcqyQyOxxrB3cIcbhcqyQyOxxrC9e4sbhcqyQyMeCboLqSw7NOKRoLuQyrJDIx4JugupLDs04pGgu5DKskMjHgm6C6ksOzTikaC7kMqyQyMeCboLqSw7NOKRoLuQyrJDIx4JugupLDs04pGgu5DKskMjHgm6C6ksOzTikaC7kMqy89t/LRJ0F3CEvxaT9AiGynGkP3eb2TyOleBEqzOrrDj6D68Nj5XginJGo//xzenr1Bsa/kt7/d/gYb2dzSijoqKi4l9Sq30A+M9r/MIZv3oAAAAASUVORK5CYII="
      />
      Login with Facebook
    </button>

    <p></p>
    <button
      style="width: 250px; text-align: left"
      mat-raised-button
      (click)="userService.login('twitter')"
    >
      <img
      style="padding:8px"
      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMJSURBVGhD7ZhfiA1RHMePO/emWOVPlJQ3kSIST1IkSZT8eRCR7Jt/KXmSfVDkkS28iJS950x3lza8CU8UJUq8EF50u+zeO+fMtqh7fc/sr9tlDzszZ2aVzqe+zZ07c37f3/kz55wZ5nA4HA6HIy6isdjj6iL0xuMy9IRqFLh84Ql5lvWr+XTXL5T65HL6mQ6YbGat1hQ6TUdPq6CTRNI/EK9lFFeywFV3dP+d2gxPBLtw/khXOPovFX61CwGGoV76JxUof9mYtEHokeeo6LfonMvPTNRnU5jkwHhLOziSYH7Lo0uxQUJ72zGSiKsvJV+tYLfqs9B7GyhcMgpCHu4MivNBNtCYQ5cnBkMPrfi+M0Y8ye8FoSrQY1Tka0nIZRQxGWi9o4bgn5DURrrlrxR5uHp8+QTictQrq60ULjkeD7cZA0Oo3ACrBEvoViN4CA+aysZUregHaylUSvRsgNnBEHxMXDZRkbtRK91vTqVSbTDkjhnLxRDK7qEwdiDYpd+D/0ENGrcno4eu0liEJPYZ7ouncrCDUrDkZnM6euGt0SRPldUmyiA9egrEON6vpzO07EujUU6yXoE1GALH20G5HOk0yFV4tthgaxqlkZ5Sn1ppNMhbXL2mFOxBLzwxmuQqeZXs7Sn54Sp06djeZLKELQzZZwMqsFsv70az7FUzrSnW6G0BhtMzg2G24vI8WWYLthXbddfC4Do0ajS3FWY6JsIFZJktSL7XaJqp5AWyywERzEUlqmbjDMTlR733Ird8KIpwDcyGxpnbCgsXFGuLbo/epHH1wJhISmGbcoaiTx56fUBFeqwrg0nB+qNBKmAavbDol35TYnHE5Y0079l2YJFBlx+w2p1GL0LqdK4tr7ezepgUebDO48FOGJ7CQnYPLR4Yk4or/ZLP5XqyyZHbwzMxL5+DWTbbaAy1qNX9ahc5TBL9ch5a/gTMXxkTm0B6qKH8Ef19hyL+Q0SwFAkdQq9cQ1JPcXyHlq3j2ESyQzh+wPWHOF5BhbuZP7KQSjocDofD4fgPYewnh1ftHbHR+OoAAAAASUVORK5CYII="
      />
      Login with Twitter
    </button>
  </div>
</ng-template>
