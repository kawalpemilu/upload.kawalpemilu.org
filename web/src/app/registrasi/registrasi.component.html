<div style="padding: 0 10px">
  <ng-container *ngIf="(userService.userRelawan$ | async) as user">
    <ng-container *ngIf="user.depth > 0">
      <h2>Rekrutmen Relawan</h2>

      <p>
        Halo,

        {{ user.auth.displayName }} [<a
          style="color: blue; cursor: pointer;"
          (click)="userService.logout()"
          >Logout</a
        >]
      </p>

      <p style="font-weight: bold; color: red" *ngIf="error">{{ error }}</p>

      <p *ngIf="(code$ | async)?.claimer">
        Maaf, kode referral "{{ theCode }}" sudah tidak aktif.
      </p>

      <p>
        Relawan KawalPemilu memiliki tanggung jawab besar untuk mengawal suara
        rakyat. Idealnya, dibutuhkan sekitar 800.000 Relawan yang terpencar di
        seluruh kelurahan di Indonesia untuk standby menjaga TPS nya
        masing-masing. Ya, ada lebih dari 800.000 TPS yang perlu dijaga! banyak
        bener kan?
      </p>
      <p>
        Semua Relawan diharapkan untuk tes upload foto di TPS yang akan dia
        jaga, dengan itulah kita tahu bahwa TPS tersebut sudah tercakup. Anda
        bisa melihat persebaran Relawan saat ini di
        <a [routerLink]="['/h', 0]">Hasil Upload</a>.
      </p>

      <p>
        Bantuan Anda sangat diharapkan untuk merekrut Relawan di kelurahan
        dimana TPS nya BELUM DIJAGA siapapun. Jika ada teman Facebook anda yang
        bertempat tinggal di kelurahan tersebut, undanglah teman anda dengan
        membuat kode referral di bawah:
      </p>

      <form [formGroup]="formGroup">
        <mat-form-field style="width: 225px">
          <input
            matInput
            placeholder="Nama teman anda"
            formControlName="namaCtrl"
            type="text"
            required
          />
        </mat-form-field>
        &nbsp;
        <span *ngIf="getError('namaCtrl') as error" class="alert">
          {{ error }}
        </span>

        <button
          type="submit"
          [disabled]="formGroup.invalid || isLoading"
          mat-raised-button
          color="primary"
          (click)="createReferralCode(user.auth)"
        >
          Buat Kode Referral
        </button>
      </form>

      <ng-container *ngIf="getReferralCodes(user, false) as codes">
        <ng-container *ngIf="codes.length > 0">
          <p>
            Kirimkan URL kode referral dibawah ini ke teman anda (satu kode
            referral hanya bisa dipakai oleh satu orang):
          </p>

          <table border="1" cellspacing="0">
            <tr bgcolor="lightgray">
              <th width="30">#</th>
              <td><b>Nama</b></td>
              <td><b>URL kode referral untuk dibagikan</b></td>
            </tr>
            <tr
              *ngFor="let code of codes; let odd = odd; let i = index"
              [style.background-color]="odd ? '#FFF' : '#EEE'"
            >
              <td align="center">{{ i + 1 }}</td>
              <td>{{ user.code[code].name }}</td>
              <td style="padding: 7px">
                <input
                  type="text"
                  style="width: 300px"
                  value="https://kawal-c1.firebaseapp.com/c/{{ code }}"
                  #ui
                />
                &nbsp;
                <button
                  mat-raised-button
                  color="primary"
                  (click)="copyCode(ui)"
                >
                  <mat-icon>file_copy</mat-icon> Copy
                </button>
              </td>
            </tr>
          </table>
        </ng-container>
      </ng-container>

      <ng-container *ngIf="getReferralCodes(user, true) as codes">
        <ng-container *ngIf="codes.length > 0">
          <p>
            Berikut ini adalah teman-teman ada yang sudah menerima undangan anda
            dan telah menjadi relawan:
          </p>

          <table border="1" cellpadding="5" cellspacing="0">
            <tr bgcolor="lightgray">
              <th width="30">#</th>
              <td><b>Nama</b></td>
              <td><b>Profile teman anda</b></td>
            </tr>
            <tr
              *ngFor="let code of codes; let odd = odd; let i = index"
              [style.background-color]="odd ? '#FFF' : '#EEE'"
            >
              <td align="center">{{ i + 1 }}</td>
              <td>{{ user.code[code].name }}</td>
              <td>
                <app-orang [profile]="user.code[code].claimer"></app-orang>
              </td>
            </tr>
          </table>
        </ng-container>
      </ng-container>
    </ng-container>
  </ng-container>
</div>

<br /><br /><br /><br /><br />
